---
import Features2 from '~/components/widgets/Features2.astro';
import Features3 from '~/components/widgets/Features3.astro';
import ItemGrid3 from '~/components/ui/ItemGrid3.astro';
import Hero3 from '~/components/widgets/hero3.astro';
import Steps2 from '~/components/widgets/Steps2.astro';
import Layout from '~/layouts/PageLayout.astro';
import type { ContentEntryMap } from "astro:content";
import { getListPage } from "~/utils/lib/contentParser.astro";
import { supportedLang } from "~/utils/lib/languageParser";

export function getStaticPaths() {
  const paths = supportedLang.map((lang) => ({
    params: { lang: lang || undefined },
  }));
  return paths;
}

const { lang } = Astro.params;

const aboutPage = await getListPage("about", lang as keyof ContentEntryMap);
if (!aboutPage || aboutPage.length === 0 || !aboutPage[0].data) {
  throw new Error("About content not found for language: " + lang);
}

const { metadata, hero, heroImage, practiceAreas, values, locations, contact } = aboutPage[0].data;
---

<Layout metadata={metadata}>
  <!-- Hero Widget ******************* -->

  <Hero3
    tagline={hero.tagline}
    image={heroImage}
  >
    <Fragment slot="title">
      {hero.title}
    </Fragment>


    <Fragment slot="subtitle">
      <Fragment set:html={hero.subtitleHtml} />
    </Fragment>
  </Hero3>
    
      <!-- Features3 Widget for Practice Areas ************** -->
      {practiceAreas && (
        <Features3
          title={practiceAreas.title}
          subtitle={practiceAreas.subtitle}
          columns={4}
          isBeforeContent={true}
          items={practiceAreas.items}
        />
      )}
    
      <!-- Features3 Widget for Additional Practice Areas ************** -->

      <!-- Steps2 Widget for Values ****************** -->
      {values && (
        <Steps2
          title={values.title}
          subtitle={values.subtitle}
          items={values.items}
        />
      )}
      <!-- ItemGrid3 Widget for Office Locations ************** -->
      {locations && (
        <ItemGrid3
          items={locations}
          columns={3}
          classes={{
            container: 'gap-4 md:gap-6',
            panel: 'rounded-lg shadow-[0_4px_30px_rgba(0,0,0,0.1)] backdrop-blur border border-[#ffffff29] bg-white p-6',
            icon: 'w-16 h-16 mb-6 text-primary',
          }}
        />
      )}
    
      <!-- Features2 Widget for Contact ****************** -->
      {contact && (
        <Features2
          title={contact.title}
          tagline={contact.tagline}
          columns={2}
          items={contact.items}
        />
      )}
  </Layout>
